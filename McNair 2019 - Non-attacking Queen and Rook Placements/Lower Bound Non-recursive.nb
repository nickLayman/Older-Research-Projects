(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16822,        417]
NotebookOptionsPosition[     15441,        386]
NotebookOutlinePosition[     15784,        401]
CellTagsIndexPosition[     15741,        398]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"L", "[", 
   RowBox[{"n_", ",", " ", "q_", ",", " ", "r_"}], "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Binomial", "[", 
           RowBox[{"j", ",", 
            RowBox[{"j", "-", "q"}]}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"P", "[", 
             RowBox[{"n", ",", "j", ",", " ", 
              RowBox[{"n", "-", "j"}]}], "]"}], "-", 
            RowBox[{"L", "[", 
             RowBox[{"n", ",", "j", ",", " ", 
              RowBox[{"n", "-", "j"}]}], "]"}]}], ")"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", " ", 
           RowBox[{"q", "+", "1"}], ",", " ", "n"}], "}"}]}], "]"}], ",", " ", 
       RowBox[{"r", ">", "0"}]}], "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"r", "\[LessEqual]", "0"}]}], "}"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.786633169935336*^9, 3.786633172643854*^9}, {
  3.7866332996964455`*^9, 3.78663330826378*^9}, {3.7866333685768795`*^9, 
  3.7866333749022317`*^9}, {3.7866335476846285`*^9, 3.786633548695857*^9}, {
  3.7866337138334837`*^9, 3.7866337461856503`*^9}, {3.786633779520647*^9, 
  3.7866337838828373`*^9}, {3.786634641659268*^9, 3.786634741610496*^9}, {
  3.7866387438594484`*^9, 3.7866387450367303`*^9}, {3.7866392277462206`*^9, 
  3.786639228349406*^9}, {3.7866394482210903`*^9, 3.786639462294486*^9}, {
  3.7866404477045064`*^9, 3.7866404666169457`*^9}, {3.7866425207458615`*^9, 
  3.786642524352957*^9}, {3.78664572459101*^9, 3.7866457300093145`*^9}, {
  3.786655138888512*^9, 3.7866551501499844`*^9}, {3.7866556719478292`*^9, 
  3.7866556809453735`*^9}, {3.7920084763049583`*^9, 3.792008478157882*^9}, {
  3.792014388384926*^9, 3.7920143888583326`*^9}},
 CellLabel->
  "In[357]:=",ExpressionUUID->"b683f4b1-07b3-40ef-b766-22f24ae47092"],

Cell[BoxData[
 RowBox[{
  RowBox[{"New", "[", 
   RowBox[{"n_", ",", "q_", ",", " ", "r_"}], "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"j", "-", "q", "+", "1"}], ")"}]}], "*", 
          RowBox[{"Binomial", "[", 
           RowBox[{"j", ",", "q"}], "]"}], "*", 
          RowBox[{"P", "[", 
           RowBox[{"n", ",", "j", ",", " ", 
            RowBox[{"n", "-", "j"}]}], "]"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", " ", 
           RowBox[{"q", "+", "1"}], ",", " ", "n"}], "}"}]}], "]"}], ",", " ", 
       RowBox[{"r", ">", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"r", "\[LessEqual]", "0"}]}], "}"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.786640409709182*^9, 3.7866404284397182`*^9}, {
   3.78664051507825*^9, 3.786640546725216*^9}, {3.786640587659074*^9, 
   3.786640610555377*^9}, {3.78664069848636*^9, 3.786640735550666*^9}, {
   3.786640779732247*^9, 3.786640865428527*^9}, 3.7866426532169333`*^9, 
   3.7866452636634145`*^9, {3.786645677257929*^9, 3.7866456791714144`*^9}, {
   3.786655156746442*^9, 3.7866551684165616`*^9}, {3.7866556896559525`*^9, 
   3.786655690852207*^9}, {3.7920084816486597`*^9, 3.792008482571954*^9}, {
   3.7920143924503307`*^9, 3.7920143928612013`*^9}},
 CellLabel->
  "In[358]:=",ExpressionUUID->"11718b1a-b76c-46d0-a19f-d8909cfa0ff4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "shows", " ", "that", " ", "new", " ", "function", " ", "is", " ", 
     "equal", " ", "to", " ", "old", " ", "for", " ", "n"}], " ", 
    "\[LessEqual]", " ", "max"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"allGood", "=", "True"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"max", " ", "=", " ", "15"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"a", "=", "1"}], ",", 
     RowBox[{"a", "\[LessEqual]", "max"}], ",", 
     RowBox[{"a", "+=", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"b", "=", "0"}], ",", " ", 
       RowBox[{"b", "\[LessEqual]", "a"}], ",", " ", 
       RowBox[{"b", "+=", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"L", "[", 
           RowBox[{"a", ",", " ", "b", ",", " ", 
            RowBox[{"a", "-", "b"}]}], "]"}], "==", 
          RowBox[{"New", "[", 
           RowBox[{"a", ",", " ", "b", ",", " ", 
            RowBox[{"a", "-", "b"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         "Continue", ",", " ", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Bad: \>\"", ",", "\"\<n=\>\"", ",", "a", ",", "\"\< q=\>\"", 
           ",", "b"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{"allGood", ",", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<GOOD: Equal through n=\>\"", ",", " ", 
       RowBox[{"a", "-", "1"}]}], "]"}], ",", 
     RowBox[{"Print", "[", "\"\<Bad\>\"", "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.786640879989128*^9, 3.7866410346591253`*^9}, {
  3.7866411072238193`*^9, 3.7866411072922025`*^9}, {3.7866423541253614`*^9, 
  3.7866423543766356`*^9}, {3.7866424098011255`*^9, 3.786642448434198*^9}, {
  3.786642547262089*^9, 3.7866425778497086`*^9}, {3.7866436133773336`*^9, 
  3.7866436208286953`*^9}, {3.7866454671453495`*^9, 3.786645468004589*^9}, {
  3.7866456851824512`*^9, 3.786645686870313*^9}, {3.7866457582872972`*^9, 
  3.786645833374529*^9}, {3.7866458712265005`*^9, 3.7866460013836527`*^9}, {
  3.786646035842272*^9, 3.7866465975474215`*^9}, {3.786646661749784*^9, 
  3.7866467139665813`*^9}, {3.7866468611831627`*^9, 3.7866468616205196`*^9}, {
  3.7866551782108946`*^9, 3.786655199628584*^9}, {3.7866552718322268`*^9, 
  3.78665536664363*^9}, {3.7866557138308525`*^9, 3.786655759204183*^9}},
 CellLabel->
  "In[359]:=",ExpressionUUID->"ff28d94f-b613-4973-9914-3a2abf5c79ad"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"GOOD: Equal through n=\"\>", "\[InvisibleSpace]", "15"}],
  SequenceForm["GOOD: Equal through n=", 15],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7866462393838506`*^9, 3.7866463593528423`*^9, 3.786646392198226*^9, {
   3.7866464274542193`*^9, 3.7866464567025785`*^9}, 3.7866464883017545`*^9, {
   3.7866465254846325`*^9, 3.786646560183565*^9}, {3.786646602505988*^9, 
   3.7866466133421326`*^9}, {3.7866466676989317`*^9, 3.7866467073202267`*^9}, 
   3.7866467471469326`*^9, {3.7866468648119693`*^9, 3.7866468705458803`*^9}, 
   3.786646957747468*^9, 3.7866546902035103`*^9, 3.786654821447502*^9, 
   3.786655225256446*^9, 3.7866553877423325`*^9, 3.78665570093729*^9, 
   3.786659281352689*^9, 3.7920081536349125`*^9, 3.792008205959338*^9, 
   3.7920084909294496`*^9, 3.7920144007436028`*^9, 3.792014443943981*^9},
 CellLabel->
  "During evaluation of \
In[359]:=",ExpressionUUID->"900bd864-df69-47c7-a4c2-1eae72df505e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"L", "[", 
   RowBox[{"10", ",", "6", ",", 
    RowBox[{"10", "-", "6"}]}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "unsimplified", " ", "form", " ", "of", " ", "arbitrary", " ", "value"}], 
   " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.7866436989093294`*^9, 3.786643712168708*^9}, {
  3.7866449367654448`*^9, 3.7866449458654866`*^9}, {3.7866449801515455`*^9, 
  3.7866449853910203`*^9}, {3.786645048342634*^9, 3.7866450484088354`*^9}, {
  3.7866552112734985`*^9, 3.7866552128784943`*^9}, {3.7866554100117683`*^9, 
  3.7866554316010275`*^9}, {3.78665559158947*^9, 3.7866556170087905`*^9}, {
  3.7866558469881973`*^9, 3.7866558782320795`*^9}, {3.7920081155143237`*^9, 
  3.792008119265997*^9}},
 CellLabel->
  "In[363]:=",ExpressionUUID->"0e40cbd6-0d45-4594-a3fc-623ac83203be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"7", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{"10", ",", "7", ",", "3"}], "]"}], "-", 
     RowBox[{"8", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"10", ",", "8", ",", "2"}], "]"}], "-", 
        RowBox[{"9", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"P", "[", 
            RowBox[{"10", ",", "9", ",", "1"}], "]"}], "-", 
           RowBox[{"10", " ", 
            RowBox[{"P", "[", 
             RowBox[{"10", ",", "10", ",", "0"}], "]"}]}]}], ")"}]}], "-", 
        RowBox[{"45", " ", 
         RowBox[{"P", "[", 
          RowBox[{"10", ",", "10", ",", "0"}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{"36", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"10", ",", "9", ",", "1"}], "]"}], "-", 
        RowBox[{"10", " ", 
         RowBox[{"P", "[", 
          RowBox[{"10", ",", "10", ",", "0"}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{"120", " ", 
      RowBox[{"P", "[", 
       RowBox[{"10", ",", "10", ",", "0"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{"28", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{"10", ",", "8", ",", "2"}], "]"}], "-", 
     RowBox[{"9", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"10", ",", "9", ",", "1"}], "]"}], "-", 
        RowBox[{"10", " ", 
         RowBox[{"P", "[", 
          RowBox[{"10", ",", "10", ",", "0"}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{"45", " ", 
      RowBox[{"P", "[", 
       RowBox[{"10", ",", "10", ",", "0"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{"84", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{"10", ",", "9", ",", "1"}], "]"}], "-", 
     RowBox[{"10", " ", 
      RowBox[{"P", "[", 
       RowBox[{"10", ",", "10", ",", "0"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{"210", " ", 
   RowBox[{"P", "[", 
    RowBox[{"10", ",", "10", ",", "0"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.7920081440825825`*^9, 3.792008153828014*^9}, 
   3.7920082061160336`*^9, 3.792008491170932*^9, 3.7920144008217087`*^9, 
   3.7920144440533648`*^9},
 CellLabel->
  "Out[363]=",ExpressionUUID->"78e9d1e0-4d75-4d80-b4d6-c15eb47b594b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Expand", "[", 
   RowBox[{"L", "[", 
    RowBox[{"10", ",", "6", ",", " ", 
     RowBox[{"10", "-", "6"}]}], "]"}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "simplified", " ", "form", " ", "of", " ", "above", " ", "expression"}], 
   " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.7866556202074823`*^9, 3.7866556619689198`*^9}, {
  3.7866558013676677`*^9, 3.7866558205188093`*^9}, {3.7866558847715197`*^9, 
  3.7866558939702883`*^9}, {3.792008122127138*^9, 3.792008124549303*^9}},
 CellLabel->
  "In[364]:=",ExpressionUUID->"fd46101d-a892-451e-b2f2-33947dee8947"],

Cell[BoxData[
 RowBox[{
  RowBox[{"7", " ", 
   RowBox[{"P", "[", 
    RowBox[{"10", ",", "7", ",", "3"}], "]"}]}], "-", 
  RowBox[{"28", " ", 
   RowBox[{"P", "[", 
    RowBox[{"10", ",", "8", ",", "2"}], "]"}]}], "+", 
  RowBox[{"84", " ", 
   RowBox[{"P", "[", 
    RowBox[{"10", ",", "9", ",", "1"}], "]"}]}], "-", 
  RowBox[{"210", " ", 
   RowBox[{"P", "[", 
    RowBox[{"10", ",", "10", ",", "0"}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.792014400852955*^9, 3.7920144441314383`*^9},
 CellLabel->
  "Out[364]=",ExpressionUUID->"fc07484e-0e84-4994-a422-017d74900425"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"New", "[", 
   RowBox[{"10", ",", "6", ",", " ", 
    RowBox[{"10", "-", "6"}]}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "all", " ", "coefficients", " ", "of", " ", "old", " ", "and", " ", "new", 
    " ", "value", " ", "are", " ", "equal"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.7866437164734793`*^9, 3.7866437455771747`*^9}, {
  3.78664489027032*^9, 3.786644890317279*^9}, {3.7866449496484566`*^9, 
  3.7866449497110586`*^9}, {3.7866450429058924`*^9, 3.786645042983962*^9}, {
  3.7866456925636168`*^9, 3.786645693036728*^9}, {3.7866550472123327`*^9, 
  3.7866550513524323`*^9}, {3.786655218119306*^9, 3.78665521935909*^9}, {
  3.786655897002151*^9, 3.7866559452754984`*^9}, {3.792008127502222*^9, 
  3.7920081296607046`*^9}},
 CellLabel->
  "In[365]:=",ExpressionUUID->"409afc2e-a41d-44c0-bbab-d6a76fe703c7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"7", " ", 
   RowBox[{"P", "[", 
    RowBox[{"10", ",", "7", ",", "3"}], "]"}]}], "-", 
  RowBox[{"28", " ", 
   RowBox[{"P", "[", 
    RowBox[{"10", ",", "8", ",", "2"}], "]"}]}], "+", 
  RowBox[{"84", " ", 
   RowBox[{"P", "[", 
    RowBox[{"10", ",", "9", ",", "1"}], "]"}]}], "-", 
  RowBox[{"210", " ", 
   RowBox[{"P", "[", 
    RowBox[{"10", ",", "10", ",", "0"}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.7866437461706085`*^9, {3.7866448865119047`*^9, 3.7866448921302214`*^9}, 
   3.7866449499765034`*^9, {3.7866450388801003`*^9, 3.7866450433432503`*^9}, 
   3.786645165084291*^9, {3.786645711310899*^9, 3.7866457412195015`*^9}, 
   3.786646877501122*^9, 3.7866469579216003`*^9, 3.786654690469533*^9, 
   3.7866548217069983`*^9, 3.7866550520530033`*^9, 3.7866552254605656`*^9, 
   3.7866553879380035`*^9, 3.7866557012689404`*^9, 3.7866592817180743`*^9, {
   3.792008130439732*^9, 3.7920081542887893`*^9}, 3.792008206375667*^9, 
   3.792008491538622*^9, 3.7920144009310584`*^9, 3.7920144442015896`*^9},
 CellLabel->
  "Out[365]=",ExpressionUUID->"af880c3c-2367-47a1-8a49-1769f4c49ec9"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
    "The", " ", "new", " ", "representation", " ", "of", " ", "our", " ", 
     "lower", " ", "bound", " ", "for", " ", "P_n", 
     RowBox[{"(", 
      RowBox[{"q", ",", " ", "r"}], ")"}], " ", "is", " ", "the", " ", 
     "alternating", " ", "sum", " ", "of", " ", 
     RowBox[{"(", 
      RowBox[{"i", " ", "choose", " ", "q"}], ")"}], "*", "P_n", 
     RowBox[{"(", 
      RowBox[{"i", ",", " ", 
       RowBox[{"n", " ", "-", " ", "i"}]}], ")"}], " ", "for", " ", "q"}], 
    " ", "+", " ", "1"}], " ", "\[LessEqual]", " ", "i", " ", "\[LessEqual]", 
   " ", 
   RowBox[{"n", " ", "with", " ", "the", " ", "first", " ", "term", " ", 
    RowBox[{"(", 
     RowBox[{"smallest", " ", "i"}], ")"}], " ", "\[IndentingNewLine]", 
    "always", " ", "positive"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.7866559781644187`*^9, 3.786656152002475*^9}, {
  3.7866589097914543`*^9, 3.7866590885376043`*^9}, {3.786659159067521*^9, 
  3.7866591706232576`*^9}},
 CellLabel->
  "In[366]:=",ExpressionUUID->"af43d3c8-6594-4b95-a2d2-bc679f80c8a7"]
},
WindowSize->{759, 833},
WindowMargins->{{Automatic, 222}, {15, Automatic}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2022, 43, 67, "Input",ExpressionUUID->"b683f4b1-07b3-40ef-b766-22f24ae47092"],
Cell[2583, 65, 1661, 38, 67, "Input",ExpressionUUID->"11718b1a-b76c-46d0-a19f-d8909cfa0ff4"],
Cell[CellGroupData[{
Cell[4269, 107, 2674, 56, 219, "Input",ExpressionUUID->"ff28d94f-b613-4973-9914-3a2abf5c79ad"],
Cell[6946, 165, 980, 17, 22, "Print",ExpressionUUID->"900bd864-df69-47c7-a4c2-1eae72df505e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7963, 187, 824, 17, 28, "Input",ExpressionUUID->"0e40cbd6-0d45-4594-a3fc-623ac83203be"],
Cell[8790, 206, 2258, 65, 90, "Output",ExpressionUUID->"78e9d1e0-4d75-4d80-b4d6-c15eb47b594b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11085, 276, 607, 14, 28, "Input",ExpressionUUID->"fd46101d-a892-451e-b2f2-33947dee8947"],
Cell[11695, 292, 576, 16, 32, "Output",ExpressionUUID->"fc07484e-0e84-4994-a422-017d74900425"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12308, 313, 866, 17, 28, "Input",ExpressionUUID->"409afc2e-a41d-44c0-bbab-d6a76fe703c7"],
Cell[13177, 332, 1131, 24, 32, "Output",ExpressionUUID->"af880c3c-2367-47a1-8a49-1769f4c49ec9"]
}, Open  ]],
Cell[14323, 359, 1114, 25, 100, "Input",ExpressionUUID->"af43d3c8-6594-4b95-a2d2-bc679f80c8a7"]
}
]
*)

